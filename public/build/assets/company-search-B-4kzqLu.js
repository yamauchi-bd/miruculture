document.addEventListener("DOMContentLoaded",function(){const i=document.getElementById("company-search"),n=document.getElementById("search-results"),a=document.getElementById("search-button");let o;i.addEventListener("input",function(){clearTimeout(o),o=setTimeout(()=>{const e=this.value.trim();e.length>1?d(e):(n.innerHTML="",n.classList.add("hidden"))},300)}),a.addEventListener("click",function(e){e.preventDefault();const t=i.value.trim();t.length>1&&d(t)});function d(e){fetch(`/companies/search?query=${encodeURIComponent(e)}`).then(t=>t.json()).then(t=>{r(t)}).catch(t=>{console.error("Error:",t)})}function r(e){if(n.innerHTML="",e.length===0)n.innerHTML='<p class="p-2">検索結果がありません。</p>';else{const t=document.createElement("ul");t.className="divide-y divide-gray-200",e.forEach(s=>{const c=document.createElement("li");c.className="p-2 hover:bg-gray-100 cursor-pointer",c.innerHTML=`
                    <div class="font-medium">${s.company_name}</div>
                    <div class="text-xs text-gray-500">${s.location}</div>
                `,c.addEventListener("click",()=>{window.location.href=`/companies/${s.corporate_number}`}),t.appendChild(c)}),n.appendChild(t)}n.classList.remove("hidden")}document.addEventListener("click",function(e){!n.contains(e.target)&&e.target!==i&&n.classList.add("hidden")})});
