document.addEventListener("DOMContentLoaded",function(){const i=document.getElementById("company-input"),n=document.getElementById("input-results"),a=document.getElementById("corporate_number"),r=document.getElementById("company_name"),u=document.getElementById("input-button");let o;i.addEventListener("input",function(){clearTimeout(o),o=setTimeout(()=>{const e=this.value.trim();e.length>1?s(e):(n.innerHTML="",n.classList.add("hidden"))},300)}),u.addEventListener("click",function(e){e.preventDefault();const t=i.value.trim();t.length>1&&s(t)});function s(e){fetch(`/companies/search?query=${encodeURIComponent(e)}`).then(t=>t.json()).then(t=>{l(t)}).catch(t=>{console.error("Error:",t)})}function l(e){if(n.innerHTML="",e.length===0)n.innerHTML='<p class="p-2">検索結果がありません。</p>';else{const t=document.createElement("ul");t.className="divide-y divide-gray-200",e.forEach(c=>{const d=document.createElement("li");d.className="p-2 hover:bg-gray-100 cursor-pointer",d.innerHTML=`
                    <div class="font-medium">${c.company_name}</div>
                    <div class="text-xs text-gray-500">${c.location}</div>
                `,d.addEventListener("click",()=>{i.value=c.company_name,a.value=c.corporate_number,r.value=c.company_name,n.classList.add("hidden")}),t.appendChild(d)}),n.appendChild(t)}n.classList.remove("hidden")}document.addEventListener("click",function(e){!n.contains(e.target)&&e.target!==i&&n.classList.add("hidden")})});
