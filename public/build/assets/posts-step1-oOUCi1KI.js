document.addEventListener("DOMContentLoaded",function(){console.log("Step 1: DOMContentLoaded event fired"),d(),m(),p()});function d(){const r=document.getElementById("job-categories");if(!r){console.error("job-categories element not found");return}const n=JSON.parse(r.dataset.categories),s=document.getElementById("job_category");if(!s){console.error("job_category element not found");return}s.addEventListener("change",function(){u(this.value,n)})}function u(r,n){const s=document.getElementById("job_subcategory");s.innerHTML='<option value="">選択してください</option>',r&&n[r]&&n[r].forEach(c=>{const o=document.createElement("option");o.value=c.id,o.textContent=c.name,s.appendChild(o)})}function m(){document.querySelector("form").addEventListener("submit",function(n){n.preventDefault(),y()?this.submit():console.log("フォームのバリデーションに失敗しました")})}function y(){const r=document.querySelectorAll("input[required], select[required], textarea[required]");let n=!0;r.forEach(t=>{let e;if(t.type==="radio"){e=document.getElementById(`${t.name}-error`);const a=document.querySelectorAll(`input[name="${t.name}"]`);Array.from(a).some(i=>i.checked)?(a.forEach(i=>i.classList.remove("error")),e&&(e.style.display="none")):(n=!1,a.forEach(i=>i.classList.add("error")),e&&(e.textContent="このフィールドは必須です。",e.style.display="block"))}else t.type==="select-one"?(e=document.getElementById(`${t.id}-error`),t.value===""?(n=!1,t.classList.add("error"),e&&(e.textContent="このフィールドは必須です。",e.style.display="block")):(t.classList.remove("error"),e&&(e.style.display="none"))):t.value.trim()?(t.classList.remove("error"),e&&(e.style.display="none")):(e=document.getElementById(`${t.id}-error`),n=!1,t.classList.add("error"),e&&(e.textContent="このフィールドは必須です。",e.style.display="block"))});const s=document.querySelector('input[name="status"]:checked'),c=document.getElementById("end_year"),o=document.getElementById("end_year-error");return s&&s.value==="退職済み"&&(!c.value||c.value==="")?(n=!1,c.classList.add("error"),o&&(o.textContent="退職年を選択してください。",o.style.display="block")):(c.classList.remove("error"),o&&(o.style.display="none")),n}function p(){const r=document.querySelectorAll('input[name="status"]'),n=document.getElementById("start_year"),s=document.getElementById("end_year");n.addEventListener("change",function(){c()});function c(){const t=parseInt(n.value),e=new Date().getFullYear();s.innerHTML='<option value="" selected disabled>退職年</option>';for(let a=t;a<=e;a++){const l=document.createElement("option");l.value=a,l.textContent=a+"年",s.appendChild(l)}o()}function o(){var l;const t=document.getElementById("end_year");if(!t)return;const e=((l=document.querySelector('input[name="status"]:checked'))==null?void 0:l.value)==="在籍中";t.style.display=e?"none":"inline-block",t.disabled=e,t.required=!e,e&&(t.value="");const a=document.getElementById("end_year-error");a&&(a.style.display="none")}r.forEach(t=>{t.addEventListener("change",o)}),c(),o()}
