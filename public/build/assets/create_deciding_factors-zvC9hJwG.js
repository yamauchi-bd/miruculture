document.addEventListener("DOMContentLoaded",function(){d(),m(),f(),h(),p(),E(),v()});function d(){for(let t=2;t<=3;t++)u(t)}function u(t){const e=document.querySelectorAll(`input[name="factor_${t}"]`),n=document.getElementById(`detail_${t}`),c=document.querySelectorAll(`input[name="satisfaction_${t}"]`);e.forEach(a=>{a.addEventListener("change",function(){const o=document.querySelector(`input[name="factor_${t}"]:checked`)!==null;console.log(`Factor ${t} selected: ${o}`),n.required=o,c.forEach(s=>s.required=o)})})}function f(){const t=document.getElementById("add-factor-button"),e=document.getElementById("factor-2"),n=document.getElementById("factor-3");t.addEventListener("click",function(){e.classList.contains("hidden")?e.classList.remove("hidden"):n.classList.contains("hidden")&&(n.classList.remove("hidden"),t.style.display="none")})}function m(){document.querySelectorAll(".factor-label").forEach(e=>{e.addEventListener("click",function(n){n.preventDefault();const c=this.previousElementSibling,a=c.name;c.checked=!c.checked,document.querySelectorAll(`input[name="${a}"]`).forEach(o=>{o!==c&&(o.checked=!1)}),y(a),updateAvailableOptions()})})}function y(t){document.querySelectorAll(`input[name="${t}"] + .factor-label`).forEach(e=>{e.previousElementSibling.checked?(e.classList.add("bg-cyan-500","text-white"),e.classList.remove("bg-white","text-gray-700")):(e.classList.remove("bg-cyan-500","text-white"),e.classList.add("bg-white","text-gray-700"))})}function h(){const t=document.querySelectorAll(".deciding-factor"),e={};t.forEach(c=>{const a=c.getAttribute("name");e[a]||(e[a]=[]),e[a].push(c)});function n(){const c=new Set;Object.values(e).forEach(a=>{a.forEach(o=>{o.checked&&c.add(o.value)})}),Object.values(e).forEach(a=>{a.forEach(o=>{const s=o.nextElementSibling;c.has(o.value)&&!o.checked?(o.disabled=!0,s.classList.add("opacity-50","cursor-not-allowed"),s.style.pointerEvents="none"):(o.disabled=!1,s.classList.remove("opacity-50","cursor-not-allowed"),s.style.pointerEvents="auto")})})}n(),window.updateAvailableOptions=n}function p(){document.querySelectorAll(".flex.items-center").forEach(e=>{const n=e.querySelectorAll("svg"),c=e.querySelectorAll('input[type="radio"]');n.forEach((a,o)=>{a.addEventListener("click",()=>{c[o].checked=!0,n.forEach((s,i)=>{i<=o?(s.classList.add("text-cyan-500"),s.classList.remove("text-gray-300")):(s.classList.add("text-gray-300"),s.classList.remove("text-cyan-500"))})})})})}function E(){document.querySelector("form").addEventListener("submit",function(e){e.preventDefault(),g()?this.submit():console.log("フォームのバリデーションに失敗しました")})}function g(){let t=!0;for(let e=1;e<=3;e++){const n=document.querySelectorAll(`input[name="factor_${e}"]`),c=document.getElementById(`detail_${e}`),a=document.querySelectorAll(`input[name="satisfaction_${e}"]`),o=Array.from(n).some(i=>i.checked),s=Array.from(a).some(i=>i.checked);(e===1||o)&&(o?l(`factor_${e}-error`):(t=!1,r(`factor_${e}-error`,"入社の決め手を選択してください。")),c.value.length<100?(t=!1,r(`detail_${e}-error`,"詳細は100文字以上入力してください。")):l(`detail_${e}-error`),s?l(`satisfaction_${e}-error`):(t=!1,r(`satisfaction_${e}-error`,"満足度を選択してください。")))}return t}function r(t,e){const n=document.getElementById(t);n&&(n.textContent=e,n.style.display="block")}function l(t){const e=document.getElementById(t);e&&(e.style.display="none")}function v(){for(let t=1;t<=3;t++){const e=document.getElementById(`detail_${t}`),n=document.getElementById(`detail_${t}_count`);e&&n&&e.addEventListener("input",function(){n.textContent=this.value.length})}}
