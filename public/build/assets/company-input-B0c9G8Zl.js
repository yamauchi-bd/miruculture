document.addEventListener("DOMContentLoaded",function(){const o=document.getElementById("company-input"),t=document.getElementById("input-results"),a=document.getElementById("corporate_number"),r=document.getElementById("company_name"),l=document.getElementById("input-button");let d;o.addEventListener("input",function(){clearTimeout(d),d=setTimeout(()=>{const e=this.value.trim();e.length>1?s(e):(t.innerHTML="",t.classList.add("hidden"))},300)}),l.addEventListener("click",function(e){e.preventDefault();const c=o.value.trim();c.length>1&&s(c)});function s(e){const c=`${window.appUrl}/companies/search?query=${encodeURIComponent(e)}`;console.log("Fetching from:",c),fetch(c).then(n=>n.json()).then(n=>{u(n)}).catch(n=>{console.error("Error:",n)})}function u(e){if(t.innerHTML="",e.length===0)t.innerHTML='<p class="p-2">検索結果がありません。</p>';else{const c=document.createElement("ul");c.className="divide-y divide-gray-200",e.forEach(n=>{const i=document.createElement("li");i.className="p-2 hover:bg-gray-100 cursor-pointer",i.innerHTML=`
                    <div class="font-medium">${n.company_name}</div>
                    <div class="text-xs text-gray-500">${n.location}</div>
                `,i.addEventListener("click",()=>{o.value=n.company_name,a.value=n.corporate_number,r.value=n.company_name,t.classList.add("hidden")}),c.appendChild(i)}),t.appendChild(c)}t.classList.remove("hidden")}document.addEventListener("click",function(e){!t.contains(e.target)&&e.target!==o&&t.classList.add("hidden")})});
