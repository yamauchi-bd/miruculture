document.addEventListener("DOMContentLoaded",function(){s(),m(),i(),setupShareModal()});function s(){document.querySelectorAll('input[type="range"]').forEach(n=>{u(n),n.addEventListener("input",function(){u(this)})})}function u(t){const n=t.min||1,e=t.max||5,r=(t.value-n)/(e-n)*100;t.style.background=`linear-gradient(to right, #0891b2 0%, #0891b2 ${r}%, #d1d5db ${r}%, #d1d5db 100%)`}function m(){const t=document.querySelector("form");document.getElementById("submit-button"),t.addEventListener("submit",function(e){e.preventDefault(),a()?this.submit():alert("フォームのバリデーションに失敗しました。すべての項目を入力し、自由記述の合計が200文字以上であることを確認してください。")}),document.querySelectorAll('textarea[id^="culture_detail_"]').forEach(e=>{e.addEventListener("input",function(){i(),a()})})}function a(){const t=document.querySelectorAll('input[type="range"]'),n=document.querySelectorAll('textarea[id^="culture_detail_"]');let e=!0,o=0;t.forEach(c=>{c.value?d(c.name):(e=!1,l(c.name))}),n.forEach(c=>{o+=c.value.length}),o<200?(e=!1,l("total_char_count")):d("total_char_count");const r=document.getElementById("submit-button");return r.disabled=!e,r.classList.toggle("opacity-50",!e),e}function l(t){if(!document.getElementById(`${t}-error`)){const e=t==="total_char_count"?document.querySelector(".mt-20"):document.querySelector(`input[name="${t}"]`).closest(".mb-10"),o=document.createElement("p");o.id=`${t}-error`,o.className="text-red-500 text-xs mt-1",o.textContent=t==="total_char_count"?"自由記述の合計文字数は200文字以上である必要があります。":"この項目は必須です",e.appendChild(o)}}function d(t){const n=document.getElementById(`${t}-error`);n&&n.remove()}function i(){const t=document.querySelectorAll('textarea[id^="culture_detail_"]'),n=document.querySelectorAll('span[id^="culture_detail_count_"]');let e=0;t.forEach(o=>{e+=o.value.length}),n.forEach(o=>{o.textContent=e,o.classList.toggle("text-red-500",e<200)})}
