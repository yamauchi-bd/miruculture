document.addEventListener("DOMContentLoaded",function(){const o=document.getElementById("decidingFactorsChart").getContext("2d"),b=document.getElementById("decidingFactorsData"),n=JSON.parse(b.textContent);if(Object.keys(n).length===0)return;const d=o.createLinearGradient(0,0,0,400);d.addColorStop(0,"rgba(8, 145, 178, 1)");const c=o.createLinearGradient(0,0,0,400);c.addColorStop(0,"rgba(6, 182, 212, 1)");const p=o.createLinearGradient(0,0,0,400);p.addColorStop(0,"rgba(93, 217, 217, 1)");const l={type:"bar",data:{labels:n.map(e=>e.factor),datasets:[{label:"1位",data:n.map(e=>e.percentages[0]),backgroundColor:d},{label:"2位",data:n.map(e=>e.percentages[1]),backgroundColor:c},{label:"3位",data:n.map(e=>e.percentages[2]),backgroundColor:p}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,barThickness:20,scales:{x:{stacked:!0,max:100,ticks:{callback:function(e){return e+"%"},font:{family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:10}},grid:{display:!1}},y:{stacked:!0,ticks:{font:{family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:11,weight:"bold"}},grid:{display:!1}}},plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,padding:20,font:{family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleFont:{family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:10},bodyFont:{family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:10},callbacks:{label:function(e){let t=e.dataset.label||"";return t&&(t+=": "),e.parsed.x!==null&&(t+=e.parsed.x.toFixed(1)+"%"),t},afterBody:function(e){e.reduce((t,i)=>t+i.parsed.x,0)}}}}}};window.innerWidth<=640&&(l.options.scales.y.ticks.font.size=10,l.options.barThickness=10),new Chart(o,l);const u=document.getElementById("personalityTypesChart");if(u){const e=document.getElementById("personalityTypeData"),t=JSON.parse(e.textContent);if(t.length>0){const i=["INFP","INFJ","ENFP","ENFJ","ISTJ","ISFJ","ESTJ","ESFJ","INTP","INTJ","ENTP","ENTJ","ISTP","ISFP","ESTP","ESFP"],f=i.map(a=>{const s=t.find(r=>r.type===a);return s?s.count:0}),g={INFP:"#38a169",INFJ:"#2f855a",ENFP:"#48bb78",ENFJ:"#68d391",INTP:"#6b46c1",INTJ:"#553c9a",ENTP:"#805ad5",ENTJ:"#9f7aea",ISTP:"#d69e2e",ISFP:"#b7791f",ESTP:"#ecc94b",ESFP:"#f6e05e",ISTJ:"#3182ce",ISFJ:"#2b6cb0",ESTJ:"#4299e1",ESFJ:"#63b3ed"},y=i.map(a=>g[a]);new Chart(u,{type:"doughnut",data:{labels:i,datasets:[{data:f,backgroundColor:y,borderColor:"white",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"right",labels:{usePointStyle:!0,padding:15,font:{family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:10,weight:"bold"}}},tooltip:{callbacks:{label:function(a){const s=a.label||"",r=a.raw||0,m=a.dataset.data.reduce((N,E)=>N+E,0),F=Math.round(r/m*100);return`${s}: ${r}名 (${F}%)`},title:function(){return""}}}},layout:{padding:{bottom:5}},cutout:"57%"}})}}});
